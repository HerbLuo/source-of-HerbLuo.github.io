这是我几年前想出来的东西，现在依旧觉得挺完美，得瑟一下。


当时遇到了个很简单的需求，就是在生成的**PDF文件上盖上公章**。

问题点在于：客户没有电子版的公章，他们发来一个扫描件，是**一张白纸上盖着几个红章**

这就涉及到如何把红章从白纸上抠下来的问题。

来看一下错误的示范：
![](/images/抠章算法-错误抠图示例.png)

这是我们将签章系统升级到某个第三方的电子签章系统，
那个第三方公司用`Photoshop`抠出来的，简直惨不忍睹有没有！！！
(这里题外话一下，签章系统的原理非常简单，估计授权费都够开发一套全新的系统了，奈何他们有政府的认证，我们没有，所以不得不用)

其实我那时候也有尝试过Photoshop，看了下效果后果断放弃。

然后迅速就有了简单且完美的思路：

用算法，**将白度转透明度**（基色为红色）即可。

想象一下：一枚红章盖在白纸上，无论那章肉眼上看着有多么完美，实际上那颜色都是有浅有深的，浅的地方白些，深的地方红些。我们只需要将这种差异转换成透明度的差异。生成的公章，重新盖在任何颜色的PDF文件上，那都是完美的。

来看一下效果：
![](/images/抠章算法-正确抠图示例1.png)
